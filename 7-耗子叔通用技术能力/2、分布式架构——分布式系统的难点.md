#### 分布式系统的难点

##### 一、异构系统的不标准问题

主要表现在：

- 软件和应用不标准
- 通讯协议不标准
- 数据格式不标准
- 开发和运维的过程和方法不标准

##### 二、系统架构中的服务依赖性问题

分布式架构下，服务是会有依赖的，一个服务依赖链上的某个服务挂掉了，可能会导致出现“多米诺骨牌”效应。

- 如果非关键业务被关键业务所依赖，会导致非关键业务变成一个关键业务。
- 服务依赖链中，出现“木桶短板效应”——整个 SLA 由最差的那个服务所决定。

很多分布式架构在应用层上做到了业务隔离，然而，在数据库结点上并没有。如果一个非关键业务把数据库拖死，那么会导致全站不可用。所以，数据库方面也需要做相应的隔离。

##### 三、故障发生的概率更大

在分布式系统中，因为使用的机器和服务会非常多，所以，故障发生的频率会比传统的单体应用更大。只不过，单体应用的故障影响面很大，而分布式系统中，虽然故障的影响面可以被隔离，但是因为机器和服务多，出故障的频率也会多。

- 出现故障不可怕，故障恢复时间过长才可怕。
- 出现故障不可怕，故障影响面过大才可怕。

在设计时就要考虑如何减轻故障。如果无法避免，也要使用自动化的方式恢复故障，减少故障影响面。

当机器和服务数量越来越多时，人类的缺陷就成为了瓶颈。这个缺陷就是人类无法对复杂的事情做到事无巨细的管理，只有机器自动化才能帮助人类。 也就是，**人管代码，代码管机器，人不管机器！**

##### 四、多层架构的运维复杂度更大

可以把系统分成四层：**基础层、平台层、应用层和接入层**

- **基础层** 就是我们的机器、网络和存储设备等
- **平台层** 就是我们的中间件层，Tomcat、Mysql、Redis、Kafka之类的软件
- **应用层** 就是我们的业务软件，比如，各种功能的服务
- **接入层** 就是接入用户请求的网关、负载均衡或是CDN、DNS这样的东西

对于这四层，我们需要知道：

- 任何一层的问题都会导致整体的问题
- 没有统一的视图和管理，导致运维被割裂开来，造成更大的复杂度

很多公司都是按技能分工的，他们按照技能把技术团队分为产品开发、中间件开发、业务运维、系统运维等子团队。这样的分工导致的结果就是大家各管一摊，很多事情完全连不在一起。整个系统会像 “多米诺骨牌”一样，一个环节出现问题，就会倒下去一大片。

因为没有一个统一的运维视图，不知道一个服务调用是如何经过每一个服务和资源，也就导致在出现故障时要花大量的时间在沟通和定位问题上。**分工不是问题，问题是分工后的协作是否统一和规范。**

