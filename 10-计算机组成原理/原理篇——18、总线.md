#### 总线

CPU 所代表的控制器和运算器，要和存储器，也就是我们的主内存，以及输入和输出设备进行通信。那问题来了，CPU 从我们的键盘、鼠标接收输入信号，向显示器输出信号，这之间究竟是怎么通信的呢？换句话说，计算机是用什么样的方式来完成，CPU 和内存、以及外部输入输出设备的通信呢？

##### 一、总线的设计思路来源

计算机里其实有很多不同的硬件设备，除了 CPU 和内存之外，我们还有大量的输入输出设备。可以说，你计算机上的每一个接口，键盘、鼠标、显示器、硬盘，乃至通过 USB 接口连接的各种外部设备，都对应了一个设备或者模块。

如果各个设备间的通信，都是互相之间单独进行的。如果我们有 N 个不同的设备，他们之间需要各自单独连接，那么系统复杂度就会变成 N2。每一个设备或者功能电路模块，都要和其他 N−1 个设备去通信。为了简化系统的复杂度，我们就引入了总线，把这个 N2 的复杂度，变成一个 N 的复杂度。

<img src="https://liuyang-picbed.oss-cn-shanghai.aliyuncs.com/img/afdf06aeb84a92a9dfe5e9d2299e6958.jpeg" alt="afdf06aeb84a92a9dfe5e9d2299e6958" style="zoom: 25%;" />

**总线，就是一组线路。CPU、内存以及输入和输出设备，都是通过这组线路，进行相互间通信的**。总线的英文叫作 Bus，就是一辆公交车。这个名字很好地描述了总线的含义。我们的“公交车”的各个站点，就是各个接入设备。要想向一个设备传输数据，我们只要把数据放上公交车，在对应的车站下车就可以了。

##### 二、三种线路和多总线架构

现代的 Intel CPU 的体系结构里面，通常有好几条总线。

**双独立总线（Dual Independent Bus，缩写为 DIB）**，CPU 里有一个快速的 **本地总线**（Local Bus），以及一个速度相对较慢的 **前端总线**（Front-side Bus）。

**本地总线**，就是用来和高速缓存通信的。

**前端总线**，则是用来和主内存以及输入输出设备通信的。

有时候，我们会把本地总线也叫作后端总线（Back-side Bus），和前面的前端总线对应起来。而前端总线也有很多其他名字，比如处理器总线（Processor Bus）、内存总线（Memory Bus）。

<img src="https://liuyang-picbed.oss-cn-shanghai.aliyuncs.com/img/4ddbb489ceaac5e7a2c8491178db1cf9.jpeg" alt="4ddbb489ceaac5e7a2c8491178db1cf9" style="zoom:25%;" />

前端总线，其实就是系统总线。CPU 里面的内存接口，直接和系统总线通信，然后系统总线再接入一个 I/O 桥接器（I/O Bridge）。这个 I/O 桥接器，一边接入了我们的内存总线，使得我们的 CPU 和内存通信；另一边呢，又接入了一个 I/O 总线，用来连接 I/O 设备。

其实我们完全可以把总线看作一组“电线”。不过呢，这些电线之间也是有分工的，我们通常有三类线路：

（1）**数据线（Data Bus）**，用来传输实际的数据信息，也就是实际上了公交车的“人”。

（2）**地址线（Address Bus）**，用来确定到底把数据传输到哪里去，是内存的某个位置，还是某一个 I/O 设备。这个其实就相当于拿了个纸条，写下了上面的人要下车的站点。

（3）**控制线（Control Bus）**，用来控制对于总线的访问。虽然我们把总线比喻成了一辆公交车。那么有人想要做公交车的时候，需要告诉公交车司机，这个就是我们的控制信号。



尽管总线减少了设备之间的耦合，也降低了系统设计的复杂度，但同时也带来了一个新问题，那就是 **总线不能同时给多个设备提供通信功能。**

总线是很多个设备公用的，那多个设备都想要用总线，我们就需要有一个机制，去决定这种情况下，到底把总线给哪一个设备用。这个机制，就叫作 **总线裁决（Bus Arbitraction）**。

2008 年之后，我们的 Intel CPU 其实已经没有前端总线了。Intel 发明了 **快速通道互联（Intel Quick Path Interconnect，简称为 QPI）**技术，**替代了传统的前端总线**。

