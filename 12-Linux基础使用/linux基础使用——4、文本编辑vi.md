#### 文本编辑器 vi

**vi 并不是真正的编辑，原理是创建一个隐藏文件，内容都在隐藏文件中，最后替换原文件**

##### 一、普通/编辑模式

vi +10myfile  打开文件定位到第10行
vi +myfile  打开文件定位到最后一行

**字符位置移动光标：**

h : 左   j : 下  k : 上  l(L小写): 下

**单词移动光标：**
w : 移至下一个单词的词首
e : 跳至当前或下一个单词的词尾
b : 跳至当前或前一个单词的词首

**行内移动光标：**
0 : 绝对行首
^ : 行首的第一个非空白字符
\$ : 绝对行尾

**行间移动光标：**
G : 文章末尾
3G : 第3行
gg : 文章开头

**翻屏：**
ctrl + f  : 往下翻页
ctrl + b : 往上翻页

**删除字符&替换单个字符：**
x : 删除光标位置的字符
3x : 删除光标位置往前的3个字符
r : 替换光标位置字符

**删除行和单词：**
dd :  删除一行
dw :  删除一个单词

**复制粘贴&剪切：**
yw : 复制一个单词
yy : 复制一行，光标所在行
3yy : 复制三行，从光标所在行算起
y\$ : 从光标复制到这一行行尾
dd : 剪切一行，光标所在行
d\$ : 光标处开始剪切到这一行行尾
p : 光标下行粘贴（如果不是整行比如y\$这种，就在光标后面粘贴）
P  : 光标上行粘贴 （如果不是整行比如y\$这种，就在光标前面粘贴）

**撤销&重做**
u : 撤销
ctrl + r : 恢复
.  : 重复上一步操作

##### 二、模式切换 （普通/编辑模式——插入/输入模式——末行/命令模式）

i : 在光标所在字符的前面进入输入模式
I : 在光标所在行的行首进入输入模式
a : 在光标所在字符的后面进入输入模式
A : 在光标所在行的行尾进入输入模式
o : 在光标所在行的下一行进入输入模式
O : 在光标所在行的上一行进入输入模式

**esc : 从输入模式退出到编辑模式**
**:冒号 进入末行模式，从编辑模式才能进入**
:q 退出，没有修改文件
:wq  保存退出  shift + zz
:q! 不保存并退出
:w 保存， 可以:w /root/xx.txt 保存到某个文件
:w! 强行保存

##### 三、末行/命令模式

**set设置** 
:set nu  设置行号
:set nonu 取消行号
:set readonly 设置文件只读

**如果需要每次打开vim时，set都是默认生效的，需要修改vim配置 /etc/vimrc**，如：在文件末尾写 set nu

**在末行模式下执行命令！！！ 可以在编辑时同时执行命令，非常有用**
:! ls -l  （:! 后面接命令） 

**查找功能**
/xxx  向下查询xxx
?xxx 向上查询xxx
n 找寻下一个xxx
N 找寻上一个xxx

**查找并替换**
:s/str1/str2/gi
**g 表示一行内全部替换，将 str1 替换 成 str2**
**i 表示忽略大小写**

/ 为间隔符，还可以为@ #这些
*还可以使用范围，在s前面添加范围：*
n 行号，如:2s/str1/str2/gi
. 当前光标行，:.s/str1/str2/gi
+n 偏移n行，:+10s/str1/str2/gi
\$ 末尾行，  \$-2 倒数第三行，:\$s/str1/str1/gi  
% 全文，:%s/str1/str2/gi
n,m n-m行，:0,\$s/str1/str2/gi

**删除**
:0,\$d  删除全部内容
:.,+2d 删除前三行(光标必须在第一行)
:1,3d 删除1-3行
:\$-1d 删除倒数第二行
:1,\$-1d 只保留最后一行

**复制**
:1,3y 复制1-3行 ， p粘贴

##### 四、可视模式

大量重复操作时可一次行完成。
v 字符可视
V 行可视
ctrl + v 块可视，通常配合d 和 I（大写i）进行批量删除和修改操作